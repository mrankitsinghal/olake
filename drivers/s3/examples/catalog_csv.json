============================== Building driver: s3 ==============================
============================== Executing connector: s3 with args [discover --config /Users/ankit.singhal/Developer/personal/olake/drivers/s3/examples/source-csv.json] ==============================
[90m2025-11-06T11:37:31Z[0m [32mINFO[0m Connecting to S3-compatible endpoint: http://localhost:9000
[90m2025-11-06T11:37:31Z[0m [32mINFO[0m Testing connection to bucket: source-data
[90m2025-11-06T11:37:31Z[0m [32mINFO[0m Successfully connected to S3
[90m2025-11-06T11:37:31Z[0m [32mINFO[0m Discovering files in bucket: source-data with prefix: csv
[90m2025-11-06T11:37:31Z[0m [32mINFO[0m Discovered 5 files in 3 streams
[90m2025-11-06T11:37:31Z[0m [32mINFO[0m Stream grouping enabled at level 1
[90m2025-11-06T11:37:31Z[0m [32mINFO[0m Producing schema for stream: users
[90m2025-11-06T11:37:31Z[0m [32mINFO[0m Inferring schema from file: csv/users/2024-01-01/user_data.csv (2 files in stream)
[90m2025-11-06T11:37:31Z[0m [32mINFO[0m Producing schema for stream: orders
[90m2025-11-06T11:37:31Z[0m [32mINFO[0m Inferring schema from file: csv/orders/2024-01-01/order_data.csv (2 files in stream)
[90m2025-11-06T11:37:31Z[0m [32mINFO[0m Producing schema for stream: products
[90m2025-11-06T11:37:31Z[0m [32mINFO[0m Inferring CSV schema for file: csv/orders/2024-01-01/order_data.csv
[90m2025-11-06T11:37:31Z[0m [32mINFO[0m Inferring CSV schema for file: csv/users/2024-01-01/user_data.csv
[90m2025-11-06T11:37:31Z[0m [32mINFO[0m Inferring schema from file: csv/products/2024-01-01/product_data.csv.gz (1 files in stream)
[90m2025-11-06T11:37:31Z[0m [32mINFO[0m Inferring CSV schema for file: csv/products/2024-01-01/product_data.csv.gz
SDK 2025/11/06 17:07:31 WARN Response has no supported checksum. Not validating response payload.
SDK 2025/11/06 17:07:31 WARN Response has no supported checksum. Not validating response payload.
SDK 2025/11/06 17:07:31 WARN Response has no supported checksum. Not validating response payload.
[90m2025-11-06T11:37:31Z[0m [36mDEBUG[0m Using gzip decompression for file: csv/products/2024-01-01/product_data.csv.gz
[90m2025-11-06T11:37:31Z[0m [32mINFO[0m Inferred schema with 7 columns from CSV
[90m2025-11-06T11:37:31Z[0m [32mINFO[0m Inferred schema with 8 columns from CSV
[90m2025-11-06T11:37:31Z[0m [32mINFO[0m Inferred schema with 8 columns from CSV
[90m2025-11-06T11:37:31Z[0m [32mINFO[0m {"catalog":{"selected_streams":{"s3":[{"normalization":false,"partition_regex":"","stream_name":"products"},{"normalization":false,"partition_regex":"","stream_name":"users"},{"normalization":false,"partition_regex":"","stream_name":"orders"}]},"streams":[{"stream":{"available_cursor_fields":["stock","created_at","updated_at","is_active","product_id","product_name","category","price"],"destination_database":"s3_source_data:s3","destination_table":"products","name":"products","namespace":"s3","source_defined_primary_key":[],"supported_sync_modes":["full_refresh","incremental"],"sync_mode":"full_refresh","type_schema":{"properties":{"_olake_id":{"destination_column_name":"_olake_id","type":["string","null"]},"_olake_timestamp":{"destination_column_name":"_olake_timestamp","type":["timestamp_micro","null"]},"_op_type":{"destination_column_name":"_op_type","type":["string","null"]},"category":{"destination_column_name":"category","type":["string","null"]},"created_at":{"destination_column_name":"created_at","type":["string","null"]},"is_active":{"destination_column_name":"is_active","type":["boolean","null"]},"price":{"destination_column_name":"price","type":["number","null"]},"product_id":{"destination_column_name":"product_id","type":["null","integer"]},"product_name":{"destination_column_name":"product_name","type":["string","null"]},"stock":{"destination_column_name":"stock","type":["null","integer"]},"updated_at":{"destination_column_name":"updated_at","type":["null","string"]}}}}},{"stream":{"available_cursor_fields":["user_id","username","email","created_at","updated_at","status","age"],"destination_database":"s3_source_data:s3","destination_table":"users","name":"users","namespace":"s3","source_defined_primary_key":[],"supported_sync_modes":["full_refresh","incremental"],"sync_mode":"full_refresh","type_schema":{"properties":{"_olake_id":{"destination_column_name":"_olake_id","type":["string","null"]},"_olake_timestamp":{"destination_column_name":"_olake_timestamp","type":["timestamp_micro","null"]},"_op_type":{"destination_column_name":"_op_type","type":["null","string"]},"age":{"destination_column_name":"age","type":["integer","null"]},"created_at":{"destination_column_name":"created_at","type":["string","null"]},"email":{"destination_column_name":"email","type":["string","null"]},"status":{"destination_column_name":"status","type":["string","null"]},"updated_at":{"destination_column_name":"updated_at","type":["string","null"]},"user_id":{"destination_column_name":"user_id","type":["integer","null"]},"username":{"destination_column_name":"username","type":["null","string"]}}}}},{"stream":{"available_cursor_fields":["updated_at","status","order_id","user_id","product_id","amount","quantity","order_date"],"destination_database":"s3_source_data:s3","destination_table":"orders","name":"orders","namespace":"s3","source_defined_primary_key":[],"supported_sync_modes":["full_refresh","incremental"],"sync_mode":"full_refresh","type_schema":{"properties":{"_olake_id":{"destination_column_name":"_olake_id","type":["null","string"]},"_olake_timestamp":{"destination_column_name":"_olake_timestamp","type":["timestamp_micro","null"]},"_op_type":{"destination_column_name":"_op_type","type":["string","null"]},"amount":{"destination_column_name":"amount","type":["number","null"]},"order_date":{"destination_column_name":"order_date","type":["string","null"]},"order_id":{"destination_column_name":"order_id","type":["integer","null"]},"product_id":{"destination_column_name":"product_id","type":["integer","null"]},"quantity":{"destination_column_name":"quantity","type":["integer","null"]},"status":{"destination_column_name":"status","type":["string","null"]},"updated_at":{"destination_column_name":"updated_at","type":["null","string"]},"user_id":{"destination_column_name":"user_id","type":["integer","null"]}}}}}]},"type":"CATALOG"}
[90m2025-11-06T11:37:31Z[0m [32mINFO[0m Discover completed, wait 5 seconds cleanup in progress...
